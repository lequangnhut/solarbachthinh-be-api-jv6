<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thanh toán thất bại</title>

    <link rel="icon" href="/user/assets/img/vnpay-logo.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
</head>
<style>
    body {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-color: #f0f0f0;
    }

    .success-container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        padding: 50px;
        animation: slideUp 2s linear;
        background: #fff;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
    }

    @keyframes slideUp {
        0% {

        }
        100% {
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
    }

    .tick-animation {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .payment-details {
        margin-top: 50px;
    }
</style>

<body>

<div class="success-container">
    <h5 class="paymentTitle mb-5 text-danger" style="display: block;">Thanh toán thất bại</h5>
    <div class="animate__animated animate__tada tick-animation">
        <img src="/user/assets/img/vnpay-logo.png" width="100px" alt="Success tick animation">
    </div>
    <div class="payment-details" style="display: none;">
        <div class="d-flex justify-content-between">
            <p>Mã giao dịch: &nbsp;</p>
            <p><span th:text="${paymentFailedId}" class="fw-bold"></span></p>
        </div>
        <div class="d-flex justify-content-between">
            <p>Thông tin đơn hàng: &nbsp;</p>
            <p><span th:text="${orderId}" class="fw-bold"></span></p>
        </div>
        <div class="d-flex justify-content-between">
            <p>Số tiền: &nbsp;</p>
            <p><span id="totalPrice" th:text="${totalPrice}" class="fw-bold"></span></p>
        </div>
        <div class="d-flex justify-content-between">
            <p>Thời gian thanh toán: &nbsp;</p>
            <p><span id="paymentTime" th:text="${paymentTime}" class="fw-bold"></span></p>
        </div>
        <div class="d-flex justify-content-between">
            <p>Trạng thái: &nbsp;</p>
            <p class="text-danger fw-bold">Thất bại</p>
        </div>
        <div class="d-flex justify-content-between">
            <p>Tên ngân hàng: &nbsp;</p>
            <p><span th:text="${bankCode}" class="fw-bold"></span></p>
        </div>
    </div>

    <div class="mt-3 w-100">
        <a href="/" role="button" type="button" id="button-go-home" class="btn btn-outline-success button-go-home">
            Về trang chủ
        </a>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.38/moment-timezone-with-data.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

<script>
    document.querySelector('.button-go-home').style.display = 'none';
    setTimeout(() => {
        const paymentDetails = document.querySelector('.payment-details');
        const paymentTitle = document.querySelector('.paymentTitle');
        const buttonGoHome = document.querySelector('.button-go-home');
        paymentDetails.style.display = 'block';
        paymentTitle.style.display = 'block';
        buttonGoHome.style.display = 'block';
    }, 1500);

    document.addEventListener("DOMContentLoaded", function () {
        const totalPriceElement = document.getElementById("totalPrice");
        const paymentTimeElement = document.getElementById("paymentTime");

        const price = parseFloat(totalPriceElement.innerText);

        const inputDate = paymentTimeElement.innerText;
        const formattedDate = moment(inputDate, "YYYYMMDDHHmmss").tz("Asia/Ho_Chi_Minh").format("DD/MM/YYYY HH:mm:ss");

        if (!isNaN(price)) {
            totalPriceElement.innerText = new Intl.NumberFormat('vi-VN', {
                style: 'currency',
                currency: 'VND'
            }).format(price);
        }

        paymentTimeElement.innerText = formattedDate;
    });
</script>
</body>
</html>